function isMobileDevice(){return void 0!==window.orientation||-1!==navigator.userAgent.indexOf("IEMobile")}function initSlider(){$(".slideshowPlugin").addClass("swiper-container"),$(".cycle-slideshow").addClass("swiper-wrapper"),$(".swiper-wrapper").addClass("article__swiper-wrapper"),$(".slider__item").addClass("swiper-slide"),$(".slider__nav-next").addClass("swiper-button-next"),$(".slider__nav-prev").addClass("swiper-button-prev"),$(".slider__nav-next").remove(),$(".slider__nav-prev").remove(),$(".slider__pager").remove(),$(".swiper-container").append('<div class="article__swiper-pagination swiper-pagination no-print"></div>'),$(".swiper-container").append('<div class="slider__nav-prev no-print"></div>'),$(".swiper-container").append('<div class="slider__nav-next no-print"></div>');new Swiper(".swiper-container",{pagination:{el:".swiper-pagination"},navigation:{nextEl:".slider__nav-next",prevEl:".slider__nav-prev"},autoplay:{delay:5e3},loop:!1,autoHeight:!1})}var files;$((function(){var t=new Typograf({locale:["ru","en-US"]});t.disableRule("common/number/times"),t.disableRule("ru/punctuation/ano"),t.addSafeTag("<no-typography>","</no-typography>"),$(".js-automatic-typography").not(".js-article-body").each((function(e){$(this).html(t.execute($(this).html()))})),$(".js-article-body.js-automatic-typography").each((function(e){$(this).children().not(".html-widget").not(".twitter-widget").not(".instagram-widget").not(".vkontakte-widget").not(".youtube-widget").not(".js-no-typography").each((function(e){$(this).html(t.execute($(this).html()))}))}))})),$((function(){$(".js-ckeditor").each((function(){$('input[name="material[materialUUID]"]').val();var t={language:"ru",uiColor:"#ffffff",autoGrow_onStartup:!0,autoGrow_minHeight:600,autoGrow_maxHeight:$(window).height()-100,toolbarCanCollapse:!0,toolbarStartupExpanded:!0,extraPlugins:["audio","autogrow","banner","instagram","justify","originalsource","slideshow","figure","twitter","vkontakte","youtube"].join(","),removePlugins:["about","a11yhelp","resize","elementspath","filebrowser","image","scayt","table","tableselection","tabletools","uploadimage","wsc"].join(","),toolbar:[{name:"basic",items:["Source","PasteText","PasteFromWord","-","Undo","Redo"]},{name:"insert",items:["Link","Unlink","Blockquote"]},{name:"sevenbyseven",items:["InsertFigure","InsertBanner","InsertAudio","InsertTwitter","InsertInstagram","InsertVkontakte","InsertYoutube","-","InsertSevenBySeven","InsertOriginalSource"]},"/",{name:"styles",items:["Styles","Format"]},{name:"basicstyles",items:["Bold","Italic","RemoveFormat"]},{name:"paragraph",items:["NumberedList","BulletedList","-","Outdent","Indent","-","JustifyLeft","JustifyCenter","JustifyRight"]}],contentsCss:["/site-specific/7x7-journal.ru/vendor/ckeditor/contents-sevenbyseven.css"],magicline_color:"#0f7ae5"},e=$(this).get(0);window.setTimeout((function(){CKEDITOR.replace(e,t)}),500)}))})),$((function(){$(".select2").select2({language:{noResults:function(){return"Ничего не найдено"}}}),$(".select2[keep-selected-order]").on("select2:select",(function(t){var e=t.params.data.element,i=$(e);i.detach(),$(this).append(i),$(this).trigger("change")})),$(".js-href-link").on("click",(function(t){$(this).attr("href")&&(window.location.href=$(this).attr("href"))}))})),function(t,e,i){var o=!0,s=!0,n=e.head||e.getElementsByTagName("head").item(0)||e.documentElement.childNodes[0];function a(t,e){for(var i=t.split("."),o=e.split("."),s=0;s<Math.min(i.length,o.length);s++){var n=parseInt(i[s])-parseInt(o[s]);if(n)return n}return i.length-o.length}!function t(i){/in/.test(e.readyState)?setTimeout((function(){t(i)}),9):i()}((function(){for(var r=e.getElementsByClassName("soundcite"),l=0;l<r.length;l++)r[l].getAttribute("data-url")?o=!1:s=!1;!function(i,s){var r,l,c=t.Popcorn;if(o)s(c);else if(!c||a(i,c.version)>0||s(c)){var d=e.createElement("script");d.type="text/javascript",d.src="https://cdn.knightlab.com/libs/soundcite/latest/vendor/popcorn.min.js",d.onload=d.onreadystatechange=function(){o||(r=this.readyState)&&"loaded"!=r&&"complete"!=r||(l=t.Popcorn,c&&(t.Popcorn=c),s(l,o=!0),n.removeChild(d))},n.appendChild(d)}}("1.5.6",(function(o){!function(i,o){var r,l=t.SC;if(s)o(l);else if(!l||!l.Dialog||a(i,l._version)>0||o(l)){var c=e.createElement("script");c.type="text/javascript",c.src="//connect.soundcloud.com/sdk-2.0.0.js",c.onload=c.onreadystatechange=function(){s||(r=this.readyState)&&"loaded"!=r&&"complete"!=r||(o(t.SC,s=!0),n.removeChild(c))},n.appendChild(c)}}("2.0.0",(function(t){i(r,o,t)}))}))}))}(window,document,(function(t,e,i){var o={soundcloud_client_id:"5f016c08c2201881c4217afd5f52e065"};for(var s in window.SOUNDCITE_CONFIG)o[s]=window.SOUNDCITE_CONFIG[s];var n=d(o.background_color);o.background_color=n?n.join(","):"0,0,0";var a=document.createElement("style");a.type="text/css",a.innerHTML=".soundcite-loaded { background-color: rgba("+o.background_color+",.15) }",document.getElementsByTagName("head")[0].appendChild(a);var r=function(t,e){var i=Array.prototype.slice,o=i.call(arguments,2);return function(){return t.apply(e,o.concat(i.call(arguments)))}};function l(t,e){for(var i=t.className,o=0,s=e.match(/\S+/g);o<s.length;o++)i=i.replace(new RegExp("(?:^|\\s)"+s[o]+"(?!\\S)"),"");t.className=i}function c(t,e){for(var i=t.className,o=0,s=e.match(/\S+/g);o<s.length;o++)i.match(new RegExp("(?:^|\\s)"+s[o]+"(?!\\S)"))||(i+=" "+s[o]);t.className=i}function d(t){if(!t)return null;var e=[];if(i=t.match(/^(?:rgb|rgba)?\(?(\d+),(\d+),(\d+).*\)?$/)){e=[parseInt(i[1]),parseInt(i[2]),parseInt(i[3])]}else{var i;if(i=t.match(/^#?([0-9A-F]{1,2})([0-9A-F]{1,2})([0-9A-F]{1,2})$/i)){function o(t){return 1==t.length&&(t+=t),parseInt(t,16)}e=[o(i[1]),o(i[2]),o(i[3])]}}function s(t){return!isNaN(t)&&t>=0&&t<=255}return e&&s(e[0])&&s(e[1])&&s(e[2])?e:null}var u=function(t,e){var i=o.background_color||"0,0,0";t.style.cssText="background: -webkit-linear-gradient(left, rgba("+i+",.15)"+e+"%, rgba("+i+",.05)"+(e+1)+"%);background: linear-gradient(to right, rgba("+i+",.15)"+e+"%, rgba("+i+",.05)"+(e+1)+"%);"};window.soundcite={},/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?soundcite.mobile=!0:soundcite.mobile=!1;var h=[],p=document.createElement("div");function f(t){for(var e=0;e<h.length;e++)h[e].playing&&(t&&t.el===h[e].el||h[e].pause())}function m(t){this.el=t,this.start=t.hasAttribute("data-start")?t.getAttribute("data-start"):0,this.end=t.hasAttribute("data-end")?t.getAttribute("data-end"):null,this.plays=t.hasAttribute("data-plays")?parseInt(t.getAttribute("data-plays")):1,this.plays_left=this.plays,this.playing=!1,this.sound=null,h.push(this)}function g(t){m.apply(this,Array.prototype.slice.call(arguments)),this.id=t.getAttribute("data-id"),i.stream(this.id,r((function(t){this.sound=t,this.sound._player.on("positionChange",r((function(t){this.track_progress(),t>=this.end&&(this.plays?(this.plays_left--,this.plays_left>0?(this.play(),this.track_position()):this.stop()):(this.play(),this.track_position()))}),this)),null===this.end&&(this.end=this.sound.getDuration()),this.sound_loaded()}),this))}function v(t){m.apply(this,Array.prototype.slice.call(arguments)),this.id="soundcite-audio-"+h.length,this.url=t.getAttribute("data-url"),this.start=Math.floor(this.start/1e3),null!==this.end&&(this.end=Math.floor(this.end/1e3));var i=document.createElement("audio");i.id=this.id,i.setAttribute("src",this.url),i.setAttribute("preload","true"),p.appendChild(i),this.sound=e("#"+this.id,{frameAnimation:!0}),this.sound.on("loadeddata",r((function(){null===this.end&&(this.end=this.sound.duration()),this.sound.cue(this.end,r((function(){this.plays?(this.plays_left--,this.plays_left>0?(this.sound.currentTime(this.start),this.play()):(this.stop(),this.sound.currentTime(this.start))):(this.sound.currentTime(this.start),this.play())}),this)),soundcite.mobile||this.sound_loaded()}),this)),(soundcite.mobile||this.sound.readyState()>1)&&this.sound_loaded()}c(p,"soundcite-audio"),document.getElementsByTagName("body")[0].appendChild(p),i&&i.initialize({client_id:o.soundcloud_client_id}),m.prototype.sound_loaded=function(){this.el.addEventListener("click",r(this.click_handler,this)),c(this.el,"soundcite-loaded soundcite-play")},m.prototype.pause=function(){l(this.el,"soundcite-pause"),c(this.el,"soundcite-play"),this.pause_sound(),this.playing=!1},m.prototype.stop=function(){l(this.el,"soundcite-pause"),c(this.el,"soundcite-play"),this.stop_sound(),this.playing=!1,this.plays_left=this.plays},m.prototype.track_progress=function(){var t=this.end-this.start,e=100*(this.sound_position()-this.start)/t;(o.update_playing_element||u)(this.el,e)},m.prototype.click_handler=function(t){t.preventDefault(),f(this),this.playing?this.pause():this.play()},g.prototype=Object.create(m.prototype),g.prototype.sound_position=function(){return this.sound.getCurrentPosition()},g.prototype.pause_sound=function(){this.sound.pause()},g.prototype.stop_sound=function(){this.sound.stop()},g.prototype.play=function(){var t=this.sound_position();(t<this.start||t>=this.end)&&this.sound.seek(this.start),l(this.el,"soundcite-play"),c(this.el,"soundcite-pause"),this.sound.play(),this.playing=!0},v.prototype=Object.create(m.prototype),v.prototype.sound_position=function(){return this.sound.currentTime()},v.prototype.pause_sound=function(){this.sound.pause(),this.sound.off("timeupdate")},v.prototype.stop_sound=function(){this.sound.pause(),this.sound.off("timeupdate")},v.prototype._play_sound=function(){l(this.el,"soundcite-loading soundcite-play"),c(this.el,"soundcite-pause"),this.sound.play(),this.playing=!0,this.sound.on("timeupdate",r(this.track_progress,this))},v.prototype.play_sound=function(){var t=this.sound.roundTime();t<this.start||t>=this.end?(this.sound.on("seeked",r((function(){this.sound.off("seeked"),this._play_sound()}),this)),this.sound.currentTime(this.start)):this._play_sound()},v.prototype.play=function(){soundcite.mobile?(l(this.el,"soundcite-play"),c(this.el,"soundcite-loading"),this.sound.readyState()>1?this.play_sound():(this.sound.on("canplaythrough",r((function(){this.play_sound()}),this)),document.getElementById(this.id).load())):this.play_sound()};for(var b=0;b<t.length;b++){var w=t[b];w.getAttribute("data-url")?new v(w):w.getAttribute("data-id")?new g(w):(console.log('Unable to form Soundcite element because of missing attributes. The offending Soundcite was "'+w.textContent+'."'),console.log(w))}soundcite.Clip=m,soundcite.SoundCloudClip=g,soundcite.PopcornClip=v,soundcite.clips=h,soundcite.pause_all_clips=f,soundcite.normalize_background_color=d})),$(document).ready((function(){$(".payment-modal").on("show",(function(t){$(this).closest(".payment-modal-wrap").removeClass("payment-modal-wrap-hidden")})).on("close",(function(t){$(this).closest(".payment-modal-wrap").addClass("payment-modal-wrap-hidden")})),$(".js-show-payment-modal").on("click",(function(t){$(".payment-modal").trigger("show")})),$(".js-close-payment-modal").on("click",(function(t){t.stopPropagation(),$(t.target).hasClass("js-close-payment-modal")&&$(".payment-modal").trigger("close")})),$(".js-ten-years-form-amount-selector").on("click",(function(t){$(".js-ten-years-form-amount-selector").removeClass("selected"),$(".js-ten-years-form-amount-input").val(""),$(this).addClass("selected"),$(".js-ten-years-input-amount").val($(this).data("amount"))})),$(".js-ten-years-form-recurring-selector").on("click",(function(t){$(".js-ten-years-form-recurring-selector").removeClass("selected"),$(".js-ten-years-input-recurring").val($(this).data("value")),$(this).addClass("selected")})),$(".js-ten-years-form-amount-input").on("focus",(function(t){$(".js-ten-years-form-amount-selector").removeClass("selected"),$(this).val()?$(".js-ten-years-input-amount").val($(this).val()):$(".js-ten-years-input-amount").val("")})).on("blur",(function(t){$(this).val()?($(".js-ten-years-input-amount").val($(this).val()),$(this).addClass("selected")):$(this).removeClass("selected")})).on("keypress keyup blur",(function(t){return t.which>=48&&t.which<=57||8==t.which||46==t.which||t.which>=37&&t.which<=40||(t.preventDefault(),!1)})),$(".js-ten-years-form-submit-enable").on("change",(function(t){$(".js-ten-years-form-button-submit").prop("disabled",$(".js-ten-years-form-submit-enable:not(:checked)").length>0)})),$(".js-ten-years-form").submit((function(t){$(this).find('input[name="token"]').val(""),t.preventDefault();try{ym(30459802,"reachGoal","SupportButtonClicked")}catch{}return $.ajax({type:$(this).attr("method"),url:$(this).attr("action")+".json",data:$(this).serialize(),context:this,dataType:"json",success:function(t){try{ym(30459802,"reachGoal","RedirectedToPaymentGateway")}catch{}window.location=t},error:function(t){console.log("Error",t),alert("Возникла ошибка при создании платежа. Пожалуйста, попробуйте еще раз сейчас или несколько позже.")}}),!1})),$(".js-ten-years-scroll-to").on("click",(function(t){t.preventDefault();var e=document.getElementById($(this).data("target"));if(!e)return!1;e.scrollIntoView({block:"center",behavior:"smooth"})})),$(".js-article-ten-years").each((function(){initSlider()})),$(".ten-years-section-wrap.ten-years-section-progress-wrap").each((function(){new hcSticky(".ten-years-section-wrap.ten-years-section-progress-wrap",{})}))})),$(document).ready((function(){$(".js-adcampaign-popup-wrap").on("show",(function(){$(this).addClass("show")})).on("hide",(function(){$(this).removeClass("show")})),$(".js-adcampaign-popup-close").on("click",(function(){$(this).closest(".adcampaign-popup-wrap").trigger("hide")})),$(".js-adcampaign-popup-body").on("click",(function(){const t=$(this).data("href");if(!t)return!1;$(this).closest(".adcampaign-popup-wrap").trigger("hide"),window.open(t,"_blank")}))})),$((function(){$(".adcampaign").each((function(){var t=$(this).data("campaignid");const e=isMobileDevice(),i=Boolean(parseInt($(this).data("mobile")||0)),o=Boolean(parseInt($(this).data("desktop")||0));if((!e||!i)&&(e||!o))return!1;$.ajax({url:"/adcampaigns/"+t+"/show-popup.json",method:"GET",data:{URI:location.pathname},dataType:"json",context:this,success:function(t,e){var i=this;setTimeout((function(){$(i).trigger("show")}),1e3*t.delay)},error:function(t,e,i){return!1}})})),$(".js-adcampaign-inject-banner").each((function(){const t=$($(this).data("target-selector"));if(!t)return!1;const e=isMobileDevice(),i=Boolean(parseInt($(this).data("mobile")||0)),o=Boolean(parseInt($(this).data("desktop")||0));if((!e||!i)&&(e||!o))return!1;const s=t.height(),n=$(window).height();var a=null,r=!1;if(0==t.children().length)r=!0,a=t;else if(s<n)a=t.children().last();else{var l=0;t.children().each((function(t,e){if(a)return!1;(l+=$(this).outerHeight(!0))>n&&!["H1","H2","H3"].includes($(this).prop("tagName"))&&(a=$(this))}))}a&&(r?a.append($(this)):$(this).insertAfter(a),$(this).show())}))})),$(document).ready((function(){$(".js-author-subscribe-button").each((function(){null!=$(this).data("subscriber-uuid")&&$.get({url:"/subscriptions/isSubscribed.json?"+$.param({authorUUID:$(this).data("author-uuid"),subscriberUUID:$(this).data("subscriber-uuid")}),context:this,success:function(t){$(this).trigger("setSubscribeStatus",[t])}})})).on("click",(function(){if(null==$(this).data("subscriber-uuid"))window.location.href="/login?returnURL="+encodeURIComponent(window.location.href);else{const t=$(this).data("is-subscribed")?"/subscriptions/unsubscribe.json":"/subscriptions/subscribe.json";$.post({url:t,data:{authorUUID:$(this).data("author-uuid"),subscriberUUID:$(this).data("subscriber-uuid")},context:this,success:function(){$(this).trigger("toggleSubscribeStatus")}})}})).on("toggleSubscribeStatus",(function(){$(this).trigger("setSubscribeStatus",[!$(this).data("is-subscribed")])})).on("setSubscribeStatus",(function(t,e){$(this).data("is-subscribed",e),e?$(this).text($(this).data("already-subscribed-button-text")):$(this).text($(this).data("subscribe-button-text"))})).hover((function(){$(this).data("is-subscribed")&&$(this).text($(this).data("unsubscribe-button-text"))}),(function(){$(this).data("is-subscribed")&&$(this).text($(this).data("already-subscribed-button-text"))}))})),$(document).ready((function(){$(".js-countdown-timer").each((function(){var t=new Date($(this).data("deadline"));!function(t,e){var i=t.find(".js-countdown-timer-days"),o=t.find(".js-countdown-timer-hours"),s=t.find(".js-countdown-timer-minutes"),n=t.find(".js-countdown-timer-seconds");function a(){var t=function(t){var e=t-new Date,i=Math.floor(e/1e3%60),o=Math.floor(e/1e3/60%60),s=Math.floor(e/36e5%24);return{total:e,days:Math.floor(e/864e5),hours:s,minutes:o,seconds:i}}(e);i.html(t.days),o.html(("0"+t.hours).slice(-2)),s.html(("0"+t.minutes).slice(-2)),n.html(("0"+t.seconds).slice(-2)),t.total<=0&&clearInterval(r)}a();var r=setInterval(a,1e3)}($(this),t)}))})),$((function(){$(".js-blogger-tabs-item").on("click",(function(t){t.preventDefault(),$(this).parent().find(".js-blogger-tabs-item.active").trigger("deactivate"),$(this).trigger("activate")})).on("activate",(function(t){$(this).addClass("active"),$($(this).data("target")).removeClass("hidden")})).on("deactivate",(function(t){$($(this).data("target")).addClass("hidden"),$(this).removeClass("active")}))})),$(document).ready((function(){$(".js-blogger-activation-form").each((function(t){$(this).find("input:first").focus()}))})),$(document).ready((function(){$(".js-blogger-registration-form-upload-photo-input").on("change",(function(t){var e="",i=$(this).siblings("label");this.files&&this.files.length>1?e=(this.getAttribute("data-multiple-caption")||"").replace("{count}",this.files.length):t.target.value&&(e=t.target.value.split("\\").pop()),e?i.siblings(i.data("filename-display")).html(e):i.siblings(i.data("filename-display")).html("")})),$(".js-blogger-registration-form-agree-input").on("change",(function(t){var e=!$(this).is(":checked");$(this).closest("form").find(":submit").attr("disabled",e)})),$(".js-blogger-registration-form").on("submit",(function(t){return $(this).find('input[name="token"]').val(""),!0})),$("input[data-hint-selector]").on("focus",(function(){$($(this).data("hint-selector")).trigger("show")})).on("blur",(function(){$($(this).data("hint-selector")).trigger("hide")})),$(".js-blogger-registration-form-input-password").on("change keyup",(function(t){var e=zxcvbn($(this).val()).score||0;$(this).closest("form").find(".js-blogger-registration-form-password-meter").val(e),$(".js-blogger-registration-form-password-meter-text").text({0:"Непригодный пароль",1:"Плохой пароль",2:"Так себе пароль",3:"Хороший пароль",4:"Очень хороший пароль"}[e]),$(this).closest("form").find(".js-blogger-registration-form-input-password2").trigger("check-passwords-match")})),$(".js-blogger-registration-form-input-password2").on("change keyup blur",(function(t){$(this).trigger("check-passwords-match")})).on("check-passwords-match",(function(t){var e=$(this).closest("form").find(".js-blogger-registration-form-input-password").val();if(!e)return!1;e==$(this).val()?$(this).removeClass("password-not-match").addClass("password-match"):$(this).removeClass("password-match").addClass("password-not-match")})),$(".js-blogger-registration-form-input-hint").on("show",(function(){$(this).addClass("show")})).on("hide",(function(){$(this).removeClass("show")})),$(".js-blogger-registration-form").on("submit",(function(t){return $(this).find(".js-blogger-registration-form-input-password").val()==$(this).find(".js-blogger-registration-form-input-password2").val()||(alert("Введеные пароли не совпадают"),t.preventDefault(),!1)}))})),$((function(){$(".js-bloggers-grid").on("filter",(function(t,e){""==e.trim()?($(this).find(".js-bloggers-grid-group-list-item").show(),$(this).find(".js-bloggers-grid-group").show()):e.trim().length>=2&&$(this).find(".bloggers-grid-group-list").trigger("filter-group",[e])})),$(".bloggers-grid-group").on("filter-group",(function(t,e){$(this).find('.js-bloggers-grid-group-list-item[data-display-name*="'+e.trim().toLowerCase()+'"]').show(),$(this).find('.js-bloggers-grid-group-list-item:not([data-display-name*="'+e.trim().toLowerCase()+'"])').hide(),$(this).find('.js-bloggers-grid-group-list-item[data-display-name*="'+e.trim().toLowerCase()+'"]').length?$(this).show():$(this).hide()})),$(".js-bloggers-search-field").each((function(t){$(this).val()&&$($(this).data("target")).trigger("filter",[$(this).val()])})).on("keyup",(function(t){$($(this).data("target")).trigger("filter",[$(this).val()])}))})),$((function(){$(".js-comment-form-field").on("invalid-value",(function(t){$(this).addClass("invalid-value")})).on("valid-value",(function(t){$(this).removeClass("invalid-value")})),$(".js-comment-form-textarea").on("focus",(function(t){return $(this).trigger("expand"),!0})).on("blur",(function(t){return $(this).trigger("collapse"),$(this).trigger("valid-value"),!0})).on("expand",(function(t){$(this).closest(".js-comment-form-textarea-wrap").animate({height:$(this).data("height-on-focus")},300)})).on("collapse",(function(t){$(this).closest(".js-comment-form-textarea-wrap").animate({height:$(this).data("height-normal")},300)})),$(".js-comment-form").on("submit",(function(t){t.preventDefault();var e=!0;if($(this).data("authenticated")||""!=$(this).find('input[name="displayName"]').val()?$(this).find('input[name="displayName"]').trigger("valid-value"):($(this).find('input[name="displayName"]').trigger("invalid-value"),e=!1),""==$(this).find('textarea[name="commentText"]').val()?($(this).find('textarea[name="commentText"]').trigger("invalid-value"),e=!1):$(this).find('textarea[name="commentText"]').trigger("valid-value"),!e)return!1;$(this).find('input[name="token"]').val("");var i={};$(this).find("input,textarea").each((function(){i[$(this).attr("name")]=$(this).val()})),$(this).find(".js-comment-form-submit-button").prop("disabled",!0),$.ajax({type:$(this).attr("method"),url:$(this).attr("action")+".json",data:i,form:$(this),dataType:"json",success:function(t){this.form.find('input[name="parentCommentUUID"]').val()?this.form.animate({height:0},300,(function(){$(this).trigger("remove-form")})):this.form.trigger("clear-form"),alert("Комментарий отправлен. Могут происходить задержки при публикации комментариев."),$("body").data("authenticated-user")&&(window.location.href=window.location.protocol+"//"+window.location.host+window.location.pathname+"#cm_"+t.commentUUID,window.location.reload())},error:function(t){alert("Ошибка сохранения комментария"),console.log(t.responseJSON.error)},complete:function(){}})})).on("clear-form",(function(t){$(this).find('input[name="displayName"]').val(""),$(this).find('textarea[name="commentText"]').val(""),$(this).find(":focus").blur(),$(this).find(".js-comment-form-submit-button").prop("disabled",!1)})).on("remove-form",(function(t){$(this).closest(".comment").data("hasCommentForm",0),$(this).remove()})),$(".js-comment-form-submit-button").on("mousedown",(function(t){t.preventDefault()})).on("click",(function(t){t.preventDefault(),$(this).closest("form").submit()}))})),$((function(){$(".js-comment__action-reply").on("click",(function(t){t.preventDefault();var e=$(this).closest(".comment").data("comment-uuid"),i=$(this).closest(".comment"),o=$(".js-comment-form-template");if(i.data("hasCommentForm"))return!1;var s=o.clone(!0,!0);i.data("hasCommentForm",1),s.removeClass("js-comment-form-template"),s.find('input[name="parentCommentUUID"]').val(e),s.find("textarea").val(""),s.css("height","auto"),s.insertAfter(i.find(".comment__footer-wrap")),s.animate({height:"auto"},300)})),$(".js-comment__action-subscribe").on("click",(function(t){t.preventDefault();$(this).closest(".comment").data("comment-uuid")})),$(".js-comment__action-vote").on("click",(function(t){if(t.preventDefault(),$("body").data("authenticated-user"))$(this).trigger("vote");else{var e=$(this);t.stopPropagation(),$(".js-modal-login").trigger("show",[e,function(){e.trigger("vote")},!1])}})).on("vote",(function(t){var e=$(this).closest(".comment").data("comment-uuid"),i=$(this).data("vote-value");$.ajax({type:"POST",url:"/comments/"+e+"/vote.json",data:{value:i},button:$(this),success:function(t){this.button.siblings(".js-comment-votes-count").text(t)},error:function(t){}})})),$(".js-comment__action-complaint").on("click",(function(t){if(t.preventDefault(),$("body").data("authenticated-user"))$(this).trigger("complain");else{var e=$(this);t.stopPropagation(),$(".js-modal-login").trigger("show",[e,function(){e.trigger("complain")},!1])}})).on("complain",(function(t){var e=$(this).closest(".comment").data("comment-uuid"),i=prompt("Укажите причину жалобы на комментарий");i&&$.ajax({type:"POST",url:"/comments/"+e+"/complain.json",data:{text:i},success:function(t){alert("Жалоба отправлена на рассмотрение")},error:function(t){alert("Возникла ошибка при отправке жалобы")}})})),$(".js-delete-comment").on("click",(function(t){if(t.preventDefault(),!confirm("Вы уверены, что хотите удалить данный комментарий?"))return!1;var e=$(this).closest(".comment").data("comment-uuid");$.ajax({type:"DELETE",url:"/profile/comments/"+e+".json",success:function(t){alert("Комментарий удален"),window.location.href=window.location.protocol+"//"+window.location.host+window.location.pathname+"#cm_"+e,window.location.reload()},error:function(t){alert("Возникла ошибка при удалении комментария")}})}))})),$(document).ready((function(){$(".payment-modal").on("show",(function(t){$(this).closest(".payment-modal-wrap").removeClass("payment-modal-wrap-hidden")})).on("close",(function(t){$(this).closest(".payment-modal-wrap").addClass("payment-modal-wrap-hidden")})),$(".js-show-payment-modal").on("click",(function(t){$(".payment-modal").trigger("show")})),$(".js-close-payment-modal").on("click",(function(t){t.stopPropagation(),$(t.target).hasClass("js-close-payment-modal")&&$(".payment-modal").trigger("close")})),$(".js-donate-form-amount-selector").on("click",(function(t){$(".js-donate-form-amount-selector").removeClass("selected"),$(".js-donate-form-amount-input").val(""),$(this).addClass("selected"),$(".js-donate-input-amount").val($(this).data("amount"))})),$(".js-donate-form-recurring-selector").on("click",(function(t){$(".js-donate-form-recurring-selector").removeClass("selected"),$(".js-donate-input-recurring").val($(this).data("value")),$(this).addClass("selected")})),$(".js-donate-form-amount-input").on("focus",(function(t){$(".js-donate-form-amount-selector").removeClass("selected"),$(this).val()?$(".js-donate-input-amount").val($(this).val()):$(".js-donate-input-amount").val("")})).on("blur",(function(t){$(this).val()?($(".js-donate-input-amount").val($(this).val()),$(this).addClass("selected")):$(this).removeClass("selected")})).on("keyup",(function(t){if(t.which>=48&&t.which<=57||8==t.which||46==t.which||t.which>=37&&t.which<=40)return!0;t.preventDefault()})),$(".js-donate-form-submit-enable").on("change",(function(t){$(".js-donate-form-button-submit").prop("disabled",$(".js-donate-form-submit-enable:not(:checked)").length>0)})),$(".js-donate-form").submit((function(t){return $(this).find('input[name="token"]').val(""),t.preventDefault(),$.ajax({type:$(this).attr("method"),url:$(this).attr("action")+".json",data:$(this).serialize(),context:this,dataType:"json",success:function(t){window.location=t},error:function(t){console.log("Error",t),alert("Возникла ошибка при создании платежа. Пожалуйста, попробуйте еще раз сейчас или несколько позже.")}}),!1}))})),$(document).ready((function(){$(".js-donate-spoiler-toggle, .js-donate-spoiler-title").click((function(){console.log(".js-donate-spoiler-toggle .js-donate-spoiler-title clicked"),$(this).parent().toggleClass("expanded").toggleClass("collapsed"),$(this).parent().children().last().trigger("toggle")})),$(".js-donate-spoiler-content").on("toggle",(function(){console.log(".js-donate-spoiler-content clicked"),$(this).is(":visible")?$(this).slideUp():$(this).slideDown()})),$(".js-donate-scroll-to").on("click",(function(t){t.preventDefault();var e=document.getElementById($(this).data("target"));if(!e)return!1;e.scrollIntoView({block:"center",behavior:"smooth"})})),isMobileDevice()&&$(".js-donate-block-swiper-container").each((function(t){var e=$(this).data("swiper-slide-class")||"js-donate-block-swiper-slide";new Swiper($(this).get(0),{slidesPerView:"auto",wrapperClass:"js-donate-block-swiper-wrapper",slideClass:e})}))})),$((function(){$(".js-exception-close").on("click",(function(t){$(this).parent().parent().remove()}))})),$((function(){$(".filebrowser-grid-file-template").on("click",(function(t){$(this).closest("*[data-ckeditor]").length&&$(this).trigger("ckeditor-select-file",[$(this).closest("*[data-ckeditor-funcnum]").data("ckeditor-funcnum")]),t.preventDefault()})).on("clone-file",(function(t,e){var i=$(this).clone(!0,!0);i.removeClass("filebrowser-grid-file-template"),i.data("fileuuid",e.fileUUID),i.data("file-url","/files/"+e.fileUUID+"/content"),i.find(".filebrowser-grid-file-preview").css("background-image","url('/files/"+e.fileUUID+"/content')"),i.find(".filebrowser-grid-file-preview").prop("title",e.name),i.find(".filebrowser-grid-file-name").text(e.name),i.insertBefore($(this)),$(".js-filebrowser-grid-no-files").hide()})).on("ckeditor-select-file",(function(t,e){var i=$(this).data("file-url");window.opener.CKEDITOR.tools.callFunction(e,i),window.close()})),$(".js-filebrowser-grid").on("populate",(function(t,e){e.forEach((function(t,e){$(".filebrowser-grid-file-template").trigger("clone-file",[t])}))})),$(".js-filebrowser-grid-file-preview-button").on("click",(function(t){t.stopPropagation()}))})),$((function(){$(".js-filebrowser-material").on("init",(function(t){var e=$(this).data("containeruuid");$.ajax({url:"/profile/files/blogger.json",data:{"filter[containerUUID]":e}}).done((function(t){$(".js-filebrowser-grid").trigger("populate",[t])}))})).trigger("init")})),$((function(){let t=[],e=[$(".filebrowser-slider-grid-file-template").closest("*[data-callback]").data("callback")];$(".filebrowser-slider-form-file-template").on("add-slider-file",(function(e,i){var o=$(this).clone(!0,!0);o.removeClass("filebrowser-slider-form-file-template"),o.data("fileuuid",i.fileUUID),o.data("file-url","/files/"+i.fileUUID+"/content"),o.data("index",t.length),t.push(i),o.css("background-image","url('/files/"+i.fileUUID+"/content')"),o.prop("title",i.name),o.insertBefore($(this))})),$(".js-slider-cancel").on("click",(function(t){window.close()})),$(".js-slider-save").on("click",(function(i){t.length&&window.opener[e](t),window.close()})),$(".js-slider-delete").on("click",(function(e){t.splice($(this).parent().index(),1),$(this).parent().remove()}))})),$((function(){$(".filebrowser-slider-grid-file-template").on("click",(function(t){$(this).closest("*[data-ckeditor]").length&&$(this).trigger("ckeditor-select-file",[$(this).closest("*[data-callback]").data("callback")]),t.preventDefault()})).on("clone-file",(function(t,e){var i=$(this).clone(!0,!0);i.removeClass("filebrowser-slider-grid-file-template"),i.data("fileuuid",e.fileUUID),i.data("file-url","/files/"+e.fileUUID+"/content"),i.data("file-info",e),i.find(".filebrowser-slider-grid-file-preview").css("background-image","url('/files/"+e.fileUUID+"/content')"),i.find(".filebrowser-slider-grid-file-preview").prop("title",e.name),i.find(".filebrowser-slider-grid-file-name").text(e.name),i.insertBefore($(this)),$(".js-filebrowser-slider-grid-no-files").hide()})).on("ckeditor-select-file",(function(t,e){$(".filebrowser-slider-form-file-template").trigger("add-slider-file",$(this).data("file-info"))})),$(".js-filebrowser-slider-grid").on("populate",(function(t,e){e.forEach((function(t,e){$(".filebrowser-slider-grid-file-template").trigger("clone-file",[t])}))})),$(".js-filebrowser-slider-grid-file-preview-button").on("click",(function(t){t.stopPropagation()}))}));var materialUUID=$('input[name="material[materialUUID]"]').val();$("input[type=file]").on("change",(function(){files=this.files})),$(".uploadFile").on("click",(function(t){if(void 0!==files){$(this).val("Загрузка...");var e=new FormData;$.each(files,(function(t,i){e.append(t,i)})),e.append("my_file_upload",1),$.ajax({url:"/profile/file-containers/"+materialUUID+"/files.json",type:"POST",data:e,cache:!1,dataType:"json",processData:!1,contentType:!1,success:function(t,e,i){void 0===t.error?location.reload():console.log("Error: "+t.data)},error:function(t,e,i){console.log("Error: "+e,t)}})}})),$((function(){$(".js-filebrowser-slider").on("init",(function(t){var e=$(this).data("containeruuid");$.ajax({url:"/profile/files/blogger.json",data:{"filter[containerUUID]":e}}).done((function(t){$(".js-filebrowser-slider-grid").trigger("populate",[t])}))})).trigger("init")})),$((function(){$(".js-frontpage-main-content-selector-item").on("click",(function(t){$(".js-frontpage-main-content-selector-item").removeClass("active"),$(this).addClass("active");var e="";$(".js-frontpage-main-content-selector-item").each((function(t){$(this).data("content-target")&&(e=e?e+",":e,e+=$(this).data("content-target"))})),$(e).fadeOut(300),$($(this).data("content-target")).first().fadeIn(300,(function(t){$("html, body").animate({scrollTop:0},200)})),$($(this).data("content-target")).fadeIn(300)}));new Swiper(".js-frontpage-main-content-selector-swiper",{slidesPerView:"auto",wrapperClass:"js-frontpage-main-content-selector",slideClass:"js-frontpage-main-content-selector-slide",slideToClickedSlide:!0});$(".js-frontpage-main-content-selector-sticky").each((function(){new Headroom(document.querySelector(".js-frontpage-main-content-selector-sticky"),{tolerance:0,offset:0,classes:{initial:"animated",pinned:"slide-down",unpinned:"slide-up"}}).init()}))})),$((function(){$(".js-main-menu-select").on("click.mainmenuSelectClick",(function(t){t.preventDefault();var e=$(this);e.hasClass("active")?(e.removeClass("active"),$(".js-main-menu-popup").fadeOut(300),$(this).trigger("main-menu-closed"),$("body").off("click.mainmenuSelectClick")):(e.addClass("active"),$(".js-main-menu-popup").fadeIn(300),$(this).trigger("main-menu-expanded"),$("body").on("click.mainmenuSelectClick",(function(t){(0==$(t.target).closest(e).length&&0==$(t.target).closest(".js-main-menu-popup").length||$(t.target).hasClass("js-dialog-close"))&&e.trigger("click.mainmenuSelectClick")})))})).on("main-menu-expanded",(function(t){$(this).find("i").removeClass("fa-bars").addClass("fa-times")})).on("main-menu-closed",(function(t){$(this).find("i").removeClass("fa-times").addClass("fa-bars")})),$(".js-header-authenticated-user-select").on("click.authenticatedUserMenuSelectClick",(function(t){t.preventDefault();var e=$(this);e.hasClass("active")?(e.removeClass("active"),$(".js-header-authenticated-user-select-popup").fadeOut(300),$("body").off("click.authenticatedUserMenuSelectClick")):(e.addClass("active"),$(".js-header-authenticated-user-select-popup").fadeIn(300),$("body").on("click.authenticatedUserMenuSelectClick",(function(t){(0==$(t.target).closest(e).length&&0==$(t.target).closest(".js-header-authenticated-user-select-popup").length||$(t.target).hasClass("js-dialog-close"))&&e.trigger("click.authenticatedUserMenuSelectClick")})))})),$(".js-header-search-select").on("click.searchSelectClick",(function(t){t.preventDefault();var e=$(this);e.hasClass("active")?(e.removeClass("active"),$(".js-search-select-popup").fadeOut(300),$(".js-search-bar-icon-show").removeClass("fa-times"),$(".js-search-bar-icon-show").addClass("fa-search"),$("body").off("click.searchSelectClick")):(e.addClass("active"),$(".js-search-select-popup").fadeIn(300),$(".js-search-bar-icon-show").removeClass("fa-search"),$(".js-search-bar-icon-show").addClass("fa-times"),$("body").on("click.searchSelectClick",(function(t){(0==$(t.target).closest(e).length&&0==$(t.target).closest(".js-search-select-popup").length||$(t.target).hasClass("js-dialog-close"))&&e.trigger("click.searchSelectClick")})))})),$(".js-header-actual-tags-select").on("click.tagsSelectClick",(function(t){t.preventDefault();var e=$(this);e.hasClass("active")?(e.removeClass("active"),$(".js-actual-tags-select-popup").fadeOut(300),$("body").off("click.tagsSelectClick")):(e.addClass("active"),$(".js-actual-tags-select-popup").fadeIn(300),$("body").on("click.tagsSelectClick",(function(t){(0==$(t.target).closest(e).length&&0==$(t.target).closest(".js-actual-tags-select-popup").length||$(t.target).hasClass("js-dialog-close"))&&e.trigger("click.tagsSelectClick")})))})),$(".js-main-menu-popup-user-pic , .js-header-icon-dropdown").on("click.authenticatedUserPopupMenuSelectClick",(function(t){t.preventDefault();var e=$(this);e.hasClass("active")?(e.removeClass("active"),$(".js-header-authenticated-user-select-main-menu-popup-pic").fadeOut(300),$(".js-header-icon-dropdown").removeClass("fa-chevron-up"),$(".js-header-icon-dropdown").addClass("fa-chevron-down"),$("body").off("click.authenticatedUserPopupMenuSelectClick")):(e.addClass("active"),$(".js-header-authenticated-user-select-main-menu-popup-pic").fadeIn(300),$(".js-header-icon-dropdown").removeClass("fa-chevron-down"),$(".js-header-icon-dropdown").addClass("fa-chevron-up"),$("body").on("click.authenticatedUserPopupMenuSelectClick",(function(t){(0==$(t.target).closest(e).length&&0==$(t.target).closest(".js-header-authenticated-user-select-popup").length||$(t.target).hasClass("js-dialog-close"))&&e.trigger("click.authenticatedUserPopupMenuSelectClick")})))}))})),$((function(){var t=[],e={itemSelector:".grid-item",horizontalOrder:!0,gutter:20,transitionDuration:0,initLayout:!1};t.push($(".blogers-block-c-materials-grid-rated").masonry(e)),t.push($(".blogers-block-c-materials-grid-popular").masonry(e)),$(".js-blogers-block-c-material-comment-text-link").on("click",(function(t){window.location=$(this).data("uri")})),$(".js-blogers-block-c-selector-item").on("click",(function(t){t.preventDefault(),$(this).parent().find(".js-blogers-block-c-selector-item.active").trigger("deactivate"),$(this).trigger("activate")})).on("activate",(function(e){$(this).addClass("active"),$($(this).data("target")).removeClass("hidden");var i=$(this).data("target");t.forEach((function(t,e,o){t.has(i)&&t.masonry()}))})).on("deactivate",(function(t){$($(this).data("target")).addClass("hidden"),$(this).removeClass("active")})),t[0].masonry()})),$((function(){$(".js-blogers-block-d-material-comment-text-link").on("click",(function(t){window.location=$(this).data("uri")})),$(".js-blogers-block-d-selector-item").on("click",(function(t){t.preventDefault(),$(this).parent().find(".js-blogers-block-d-selector-item.active").trigger("deactivate"),$(this).trigger("activate")})).on("activate",(function(t){$(this).addClass("active"),$($(this).data("target")).removeClass("hidden")})).on("deactivate",(function(t){$($(this).data("target")).addClass("hidden"),$(this).removeClass("active")})),$(".js-blogers-search-input").autocomplete({hint:!1,minLength:3},[{source:function(t,e){var i=$(".js-blogers-search-input").data("autocomplete-uri"),o=$(".js-blogers-search-input").data("section-uuid");i=i+"?query="+encodeURIComponent(t),o&&(i=i+"&sectionUUID="+o),$.ajax({url:i,method:"GET"}).done((function(t){e(t)}))},displayKey:"displayName",templates:{suggestion:function(t){var e=$(".js-blogers-search-suggestion-item-template").clone(!0);return e.data("uri","/bloggers/"+t.loginName),e.find(".js-blogers-search-suggestion-item-user-picture").css("background-image","url("+t.picture+")"),e.find(".js-blogers-search-suggestion-item-user-name").text(t.displayName),e.find(".js-blogers-search-suggestion-item-user-rating").text(t.rating),0==t.rating&&e.find(".js-blogers-search-suggestion-item-user-rating").addClass("hidden"),e.html()}}}]).on("autocomplete:selected",(function(t,e,i,o){window.location="/bloggers/"+encodeURIComponent(e.loginName)}))})),$((function(){isMobileDevice()&&$(".js-frontpage-block-swiper-container").each((function(t){var e=$(this).data("swiper-slide-class")||"js-frontpage-block-swiper-slide";new Swiper($(this).get(0),{slidesPerView:"auto",wrapperClass:"js-frontpage-block-swiper-wrapper",slideClass:e})}))})),$(document).ready((function(){$(".js-notifications-count").each((function(){$.get({url:"/notifications/unreceivedCount.json",context:this,success:function(t){t>0?t>10?$(this).text("10+").css("visibility","visible"):$(this).text(t).css("visibility","visible"):$(this).css("visibility","hidden")}})}))})),$((function(){$(".js-login-page-tabs-item").on("click",(function(t){t.preventDefault(),$(this).parent().find(".js-login-page-tabs-item.active").trigger("deactivate"),$(this).trigger("activate")})).on("activate",(function(t){$(this).addClass("active"),$($(this).data("target")).removeClass("hidden")})).on("deactivate",(function(t){$($(this).data("target")).addClass("hidden"),$(this).removeClass("active")}))})),$(document).ready((function(){if(!$("article").data("preview-mode")&&$("article").data("material-uuid")&&$.ajax({type:"POST",url:"/statistics/material/"+$("article").data("material-uuid")+".json"}),$(".js-material-external-link").find("a").each((function(){const t=$(this).attr("href");if(!t)return!1;t.startsWith("/")||t.startsWith("#")||t.startsWith("https://7x7-journal.ru")||t.startsWith("7x7-journal.ru")||$(this).attr("target","_blank")})),$(".js-vote-material-button").on("click",(function(t){if(t.preventDefault(),$("body").data("authenticated-user"))$(this).trigger("vote");else{var e=$(this);t.stopPropagation(),$(".js-modal-login").trigger("show",[e,function(){e.trigger("vote")},!1])}})).on("vote",(function(t){var e=$(this).data("material-uuid"),i=$(this).data("vote-value");$.ajax({type:"POST",url:"/materials/"+e+"/vote.json",data:{value:i},button:$(this),success:function(t){this.button.siblings(".js-material-rating").text(t)},error:function(t){}})})),$(".article__body").each((function(){$(this).outerHeight()<$(this).data("normal-height-min-margin")&&$($(this).data("hide-elements-on-low-height")).addClass("hidden-on-low-article-height")})),$(".article__body").each((function(){initSlider()})),$("article .spoiler-title").click((function(){$(this).children().first().toggleClass("show-icon").toggleClass("hide-icon"),$(this).parent().children().last().trigger("toggle")})),$("article .spoiler-content").on("toggle",(function(){$(this).is(":visible")?$(this).slideUp():$(this).slideDown()})),isMobileDevice())new Swiper(".js-article-related-materials",{slidesPerView:"auto",wrapperClass:"js-article-related-materials-grid",slideClass:"js-article-related-materials-slide"});if($(".js-article-recent-news-container").each((function(){$(this).data("original-height",$(this).outerHeight())})).on("set-container-height",(function(){if(isMobileDevice())return!1;var t=$(".js-article-text-container").outerHeight()+$(".js-article-header-container").outerHeight();$(this).data("original-height")<t&&$(this).height(t)})),$(".js-article-text-container").each((function(){$(".js-article-recent-news-container").trigger("set-container-height")})),$(".js-material-scroll-to").on("click",(function(t){t.preventDefault();const e=document.getElementById($(this).data("scroll-target"));if(!e)return!1;e.scrollIntoView({block:"center",behavior:"smooth"})})),ResizeObserver){const t=new ResizeObserver((t=>{$(".js-article-recent-news-container").trigger("set-container-height")}));$(".js-article-text-container").get(0)&&t.observe($(".js-article-text-container").get(0),{box:"border-box"})}$(".article__body-right-column-recent-news-wrap").each((function(){new hcSticky(".article__body-right-column-recent-news-wrap",{offResolutions:[-769]})})),$(".slider__item").magnificPopup({delegate:"img",type:"image",gallery:{enabled:!0},callbacks:{elementParse:function(t){t.src=t.el[0].src}}}),$(".figure-widget").magnificPopup({type:"image",delegate:"img",callbacks:{elementParse:function(t){t.src=t.el[0].src}}})})),$((function(){new Swiper(".js-materials-header-swiper-container",{slidesPerView:"auto",wrapperClass:"js-materials-header-swiper-wrapper",slideClass:"js-materials-header-swiper-slide",slideToClickedSlide:!0})})),$(document).ready((function(){$(".js-show-modal-login").on("click",(function(t){t.preventDefault(),t.stopPropagation(),$(".js-modal-login").trigger("show",[this])})),$(".js-modal-login").on("show",(function(t,e,i,o){var s=$(this);if(t.preventDefault(),$(this).hasClass("active"))return!1;$(this).addClass("active"),$(e).length?s.css({position:"absolute",left:$(e).offset().left,top:$(e).offset().top+10}):s.css({position:"fixed",left:Math.round(($(window).width()-$(this).width())/2),top:Math.round(($(window).height()-$(this).height())/2)}),s.fadeIn(300),s.find("form").data("on-success-callback-function",i||null),o=void 0===o||o,s.find("form").data("refresh-required",o),$("body").on("click.modalLoginHide",(function(t){(0==$(t.target).closest(".js-modal-login").length||$(t.target).hasClass("js-dialog-close"))&&s.trigger("hide")}))})).on("hide",(function(t){$(this).removeClass("active"),$(this).find("form").data("on-success-callback-function",null),$(this).fadeOut(300),$("body").off("click.modalLoginClick")})),$(".js-modal-login-form").on("submit",(function(t){t.preventDefault(),$.ajax({type:$(this).attr("method"),url:$(this).attr("action")+".json",data:$(this).serialize(),form:$(this),modal:$(this).closest(".js-modal-login"),dataType:"json",onSuccessCallbackFunction:$(this).data("on-success-callback-function"),refreshRequired:$(this).data("refresh-required"),success:function(t){$("body").data("authenticated-user",1),"function"==typeof this.onSuccessCallbackFunction&&this.onSuccessCallbackFunction(),this.refreshRequired?window.location.reload():this.modal.trigger("hide")},error:function(t){this.form.trigger("authentication-failed")}})})).on("authentication-failed",(function(t){$(this).find(".js-error-message").removeClass("hidden"),$(this).find("input").addClass("invalid-value")}))})),$(document).ready((function(){$(".js-header-region-select").on("click.mapSelectClick",(function(t){t.preventDefault();var e=$(this);e.hasClass("active")?(e.removeClass("active"),$(".header-region-selector").removeClass("active"),$(".js-header-region-map").fadeOut(300),$("body").off("click.mapSelectClick")):(e.addClass("active"),$(".header-region-selector").addClass("active"),$(".js-header-region-map").fadeIn(300),$($(this).data("regions-map-container")).trigger("loadMap"),$("body").on("click.mapSelectClick",(function(t){(0==$(t.target).closest(e).length&&0==$(t.target).closest(".js-header-region-map").length||$(t.target).hasClass("js-dialog-close")||$(t.target).hasClass("js-regions-map__header-close"))&&e.trigger("click.mapSelectClick")})))})),$(".js-regions-map").on("loadMap",(function(t){$.ajax({url:"/site-specific/7x7-journal.ru/images/frontend/modal-region-selector/regions-map.svg?v.2.7",cache:!0,async:!1,dataType:"html",type:"get",context:this,success:function(t){$(this).find(".js-regions-map-container").html(t),$(this).find(".js-list-region").each((function(){const t=$(this).closest(".js-regions-map").find(".js-regions-map-container ."+$(this).data("region-name"));t&&t.attr("class",t.attr("class")+" actual "+$(this).data("region-status")+($(this).hasClass("active")?" active":""))}))}})})),$(".js-regions-map-search").on("keyup",(function(){var t=$(this).val().toLowerCase();t?$(this).closest(".js-regions-map").find(".regions-map__item").each((function(){$(".js-list-region",this).text().toLowerCase().indexOf(t)+1?$(this).stop().slideDown(100):$(this).stop().slideUp(100)})):$(".regions-map__item:hidden").slideDown(100)})),$(".js-list-region").hover((function(){var t=$(this).closest(".js-regions-map").find(".js-regions-map-container ."+$(this).data("region-name"));t.attr("class",t.attr("class")+" hovered")}),(function(){var t=$(this).closest(".js-regions-map").find(".js-regions-map-container ."+$(this).data("region-name"));t.attr("class",t.attr("class").replace(" hovered",""))})),$(".js-regions-map-container").on("mouseenter",".js-map-region.actual",(function(t){var e=$(t.target).closest(".js-regions-map"),i=$(this).attr("region");e.find(".regions-map__item").each((function(){$('.js-list-region[data-region-name="'+i+'"]',this).length?$(this).stop().slideDown(100):$(this).stop().slideUp(100)}))})),$(".js-regions-map-container").on("click",(function(t){var e=$(t.target).attr("region")||null;if(e){var i=$(this).closest(".js-regions-map").find('.js-list-region[data-region-name="'+e+'"]').attr("href");i&&(window.location.href=i)}})),$(".js-regions-map-container").on("mouseleave",(function(){$(this).closest(".js-regions-map").find(".regions-map__item").stop().slideDown(100)}))})),$(document).ready((function(){$(".js-notification").on("click",(function(){$(this).data("need-mark-notification-as-read")&&$.get({url:"/notifications/markNotificationAsRead.json?"+$.param({notificationUUID:$(this).data("notification-uuid")}),context:this,success:function(t){t&&($(this).removeClass("unread"),$(this).data("need-mark-notification-as-read",!1),$(this).children("span.notification-body-new-icon").remove(),0==$("span.notification-body-new-icon").length&&$(".js-mark-all-as-read-button").addClass("disabled"))}})})),$(".js-mark-all-as-read-button").on("click",(function(){$(this).hasClass("disabled")||$.get({url:"/notifications/markAllNotificationsAsRead.json",context:this,success:function(t){$(".js-notification").removeClass("unread"),$("span.notification-body-new-icon").remove(),$(".js-mark-all-as-read-button").addClass("disabled")}})})),$(".notification-body-editorial-office .spoiler-title").click((function(){$(this).children().first().toggleClass("show-icon").toggleClass("hide-icon"),$(this).parent().children().last().trigger("toggle")})),$(".notification-body-editorial-office .spoiler-content").on("toggle",(function(){$(this).is(":visible")?$(this).slideUp():$(this).slideDown()}))})),$(document).ready((function(){$(".js-payment-form-amount-selector").on("click",(function(t){$(".js-payment-form-amount-selector").removeClass("selected"),$(".js-payment-form-amount-input").val(""),$(this).addClass("selected"),$(".js-payment-modal-input-amount").val($(this).data("amount"))})),$(".js-payment-form-recurring-selector").on("click",(function(t){$(".js-payment-form-recurring-selector").removeClass("selected"),$(".js-payment-modal-input-recurring").val($(this).data("value")),$(this).addClass("selected")})),$(".js-payment-form-amount-input").on("focus",(function(t){$(".js-payment-form-amount-selector").removeClass("selected"),$(this).val()?$(".js-payment-modal-input-amount").val($(this).val()):$(".js-payment-modal-input-amount").val("")})).on("blur",(function(t){$(this).val()?($(".js-payment-modal-input-amount").val($(this).val()),$(this).addClass("selected")):$(this).removeClass("selected")})).on("keyup",(function(t){if(t.which>=48&&t.which<=57||8==t.which||46==t.which||t.which>=37&&t.which<=40)return!0;t.preventDefault()})),$(".js-payment-form-submit-enable").on("change",(function(t){$(".js-payment-form-button-submit").prop("disabled",$(".js-payment-form-submit-enable:not(:checked)").length>0)})),$(".js-payment-form").submit((function(t){return $(this).find('input[name="token"]').val(""),t.preventDefault(),$.ajax({type:$(this).attr("method"),url:$(this).attr("action")+".json",data:$(this).serialize(),context:this,dataType:"json",success:function(t){window.location=t},error:function(t){console.log("Error",t),alert("Возникла ошибка при создании платежа. Пожалуйста попробуйте еще раз сейчас или несколько позже.")}}),!1}))})),$(document).ready((function(){$(".payment-modal").on("show",(function(t){$(this).closest(".payment-modal-wrap").removeClass("payment-modal-wrap-hidden")})).on("close",(function(t){$(this).closest(".payment-modal-wrap").addClass("payment-modal-wrap-hidden")})),$(".js-show-payment-modal").on("click",(function(t){$(".payment-modal").trigger("show")})),$(".js-close-payment-modal").on("click",(function(t){t.stopPropagation(),$(t.target).hasClass("js-close-payment-modal")&&$(".payment-modal").trigger("close")}))})),$(document).ready((function(){$(".js-profile-kontur-access-request-form-confirmation-checkbox").on("change",(function(t){$(this).closest("form").find(":submit").prop("disabled",!$(this).prop("checked"))}))})),$(document).ready((function(){$(".js-profile-password-form-input-password").on("change keyup",(function(t){var e=zxcvbn($(this).val()).score||0;$(this).closest("form").find(".js-profile-password-form-password-meter").val(e),$(".js-profile-password-form-password-meter-text").text({0:"Непригодный пароль",1:"Плохой пароль",2:"Так себе пароль",3:"Хороший пароль",4:"Очень хороший пароль"}[e]),$(this).closest("form").find(".js-profile-password-form-input-password2").trigger("check-passwords-match")})),$(".js-profile-password-form-input-password2").on("change keyup blur",(function(t){$(this).trigger("check-passwords-match")})).on("check-passwords-match",(function(t){var e=$(this).closest("form").find(".js-profile-password-form-input-password").val();if(!e)return!1;e==$(this).val()?$(this).removeClass("password-not-match").addClass("password-match"):$(this).removeClass("password-match").addClass("password-not-match")})),$(".js-profile-password-form").on("submit",(function(t){return $(this).find(".js-profile-password-form-input-password").val()==$(this).find(".js-profile-password-form-input-password2").val()||(alert("Введеные пароли не совпадают"),t.preventDefault(),!1)})),$(".js-profile-password-form-postpone-button").on("click",(function(t){const e=$(this).closest("form");e.find("input").removeAttr("required"),e.find('input[name="postponed"]').val(1),console.log("postponed value = "+e.find('input[name="postponed"]').val()),e.submit()}))})),$((function(){"undefined"!=typeof CKEDITOR&&null!==CKEDITOR&&CKEDITOR.on("dialogDefinition",(function(t){var e=t.data.name,i=t.data.definition;"image2"==e&&(infoTab=i.getContents("info"),uploadTab=i.getContents("Upload"),infoTab.get("hasCaption").label="Отображать подпись",uploadContent=uploadTab.get("upload"),uploadButton=uploadTab.get("uploadButton"),i.removeContents("Upload"),infoTab.remove("alt"),infoTab.elements[0].id="uploadBox",uploadField=infoTab.add(uploadContent,"uploadBox"),infoTab.get("upload").onChange=function(t){var e=this.action,i=new FormData;i.append("file",this.getInputElement().$.files[0]),srcField=this._.dialog.getContentElement("info","src"),$.ajax({url:e,type:"POST",data:i,cache:!1,dataType:"json",processData:!1,contentType:!1,success:function(t,e,i){void 0===t.error?srcField.setValue(t.url):console.log("Error: "+t.data)},error:function(t,e,i){console.log("Error: "+e,t)}})})}));var t=$('input[name="material[materialUUID]"]').val(),e={language:"ru",uiColor:"#ffffff",autoGrow_onStartup:!0,autoGrow_minHeight:600,autoGrow_maxHeight:$(window).height()-100,toolbarCanCollapse:!0,toolbarStartupExpanded:!0,extraPlugins:["image2","uploadimage","autogrow","instagram","justify","slideshow","twitter","vkontakte","youtube","html","lazyload"].join(","),removePlugins:["about","a11yhelp","resize","elementspath","scayt","table","tableselection","tabletools","wsc"].join(","),toolbar:[{name:"basic",items:["Source","PasteText","PasteFromWord","-","Undo","Redo"]},{name:"insert",items:["Link","Unlink","Blockquote","HorizontalRule"]},{name:"sevenbyseven",items:["Image","InsertSlideshow","InsertVkontakte","InsertYoutube","InsertHTML"]},"/",{name:"styles",items:["Styles","Format"]},{name:"basicstyles",items:["Bold","Italic","RemoveFormat"]},{name:"paragraph",items:["NumberedList","BulletedList","-","Outdent","Indent","-","JustifyLeft","JustifyCenter","JustifyRight"]}],contentsCss:["/site-specific/7x7-journal.ru/vendor/ckeditor/contents-sevenbyseven.css"],filebrowserBrowseUrl:t?"/profile/filebrowser/blogger?filter[materialUUID]="+t:null,filebrowserUploadUrl:t?"/profile/file-containers/"+t+"/files.json?type=Files":null,filebrowserUrl:t?"/profile/filebrowser/blogger?filter[materialUUID]="+t:null,uploadUrl:t?"/profile/file-containers/"+t+"/files.json?action=upload":null,filebrowserSliderUrl:t?"/profile/filebrowser/slider/blogger?filter[materialUUID]="+t:null,magicline_color:"#0f7ae5"};if($(".js-profile-post-ckeditor").each((function(){var t=$(this).get(0),i=!1;function o(){if(1!=$("input[name='material[enabled]']").val()&&!0===i){for(var t in $(".profile-post-loader").removeClass("profile-post-no-visible"),$(".profile-post-autosave").removeClass("profile-post-no-visible"),$(".profile-post-autosave-msg").addClass("profile-post-no-visible"),CKEDITOR.instances)CKEDITOR.instances[t].updateElement();$.ajax({type:"POST",url:"/profile/posts.json",data:$(".profile-post-form").serialize(),success:function(t){$(".profile-post-loader").addClass("profile-post-no-visible"),$(".profile-post-autosave").addClass("profile-post-no-visible"),$(".profile-post-autosave-msg").removeClass("profile-post-no-visible")}}),i=!1}}window.setTimeout((function(){var s=CKEDITOR.replace(t,e);s.on("key",(function(){i=!0})),s.on("focus",(function(){setInterval(o,15e3)}))}),500)})),$(".profile-post-form-field-select2").select2({dropdownCssClass:"profile-post-form-select2",containerCssClass:"profile-post-form-select2",language:{noResults:function(){return"Ничего не найдено"}}}),$(".js-profile-post-action-button-publish").on("click",(function(t){if(t.preventDefault(),!confirm($(this).data("confirm-message")))return!1;var e=$(this).closest("form");e.find('input[name="action"]').val($(this).data("action-name")),e.submit()})),"undefined"!=typeof AlloyEditor&&null!==AlloyEditor){CKEDITOR.DEFAULT_AE_EMBED_URL_TPL="/profile/oembed?url={url}&callback={callback}";AlloyEditor.editable("material-text",{mode:"simple",extraAllowedContent:"div[style] blockquote",spritemap:"/site-specific/7x7-journal.ru/vendor/alloy-editor/assets/icons/icons.svg",toolbars:{add:{buttons:AlloyEditor.getButtons(["imageFromFile","embed","embedUrl","hline","table"])},styles:{selections:[{name:"embed",buttons:["embedRemove","embedEdit"],test:AlloyEditor.SelectionTest.embed},{name:"embedUrl",buttons:["embedVideo","embedVideoEdit"],test:AlloyEditor.SelectionTest.embedUrl},{name:"link",buttons:["linkEdit"],test:AlloyEditor.SelectionTest.link},{name:"image",buttons:["imageLeft","imageCenter","imageRight","removeImage"],test:AlloyEditor.SelectionTest.image,setPosition:AlloyEditor.SelectionSetPosition.image},{name:"text",buttons:{full:[["Font","FontSize","separator","bold","italic","underline","strike","separator","link"],["paragraphAlign","separator","ul","ol","separator","h1","h2","separator","indentBlock","outdentBlock","separator","TextColor","BGColor","separator","code","quote","separator","removeFormat"]],simple:["styles","h2","h3","bold","italic","underline","link","paragraphLeft","paragraphCenter","paragraphRight","ul","ol","quote","removeFormat","youtube",AlloyEditor.getButtons(["font"])]},test:AlloyEditor.SelectionTest.text},{name:"table",buttons:["tableHeading","tableRow","tableColumn","tableCell","tableRemove"],test:AlloyEditor.SelectionTest.table,getArrowBoxClasses:AlloyEditor.SelectionGetArrowBoxClasses,setPosition:AlloyEditor.SelectionSetPosition.table}],tabIndex:1}},language:"ru"})}})),$(document).ready((function(){$(".js-profile-posts-table-row").on("mouseover",(function(t){$(this).trigger("show.action.bar")})).on("mouseout",(function(t){$(this).trigger("hide.action.bar")})).on("show.action.bar",(function(t){$(this).find(".js-profile-posts-table-cell-actions-bar").show()})).on("hide.action.bar",(function(t){$(this).find(".js-profile-posts-table-cell-actions-bar").hide()})),$(".js-profile-posts-delete-material").on("click",(function(t){if(t.preventDefault(),!confirm($(this).data("confirm-text")))return!1;var e=$(this).closest($(this).data("node-selector"));$.ajax({type:$(this).data("method"),url:$(this).data("action")+".json",row:e,dataType:"json",success:function(t){this.row.animate({"line-height":0,opacity:0},500,(function(){$(this).remove()}))},error:function(t){alert("Ошибка удаления поста"),console.log(t.responseJSON.error)},complete:function(){}})}))}));var richPrompt=function(t){return new Promise(((e,i)=>{void 0!==this.vm?(this.vm.init(t,e,i),this.vm.show()):this.vm=new Vue({el:$(".prompt").get(0),name:"rich-prompt",data:()=>({options:t,fields:[],resolve:e,reject:i}),computed:{values(){return this.fields.map((t=>t.value))},multipleFields(){return!("string"==typeof this.options||this.options instanceof String||this.options instanceof Object||this.options instanceof Array&&1==this.options.length)}},methods:{done(){var t=this.multipleFields?this.values:this.values[this.values.length-1];this.hide(),this.resolve(t)},cancel(){this.hide(),this.reject()},show(){UIkit.modal(this.$el).show()},hide(){UIkit.modal(this.$el).hide()},addField(t){"string"==typeof t||t instanceof String?this.fields.push({type:"textarea",name:"value",label:t,value:null}):this.fields.push({type:t.type||"text",name:t.name||"value",label:t.label||"prompt",value:t.value||null})},init(t,e,i){this.resolve=e,this.reject=i,this.fields=[],t instanceof Array?t.map((t=>{this.addField(t)})):this.addField(t)}},mounted:function(){this.init(t,e,i),this.show()},destroyed:function(){this.hide()}})}))};$(document).ready((function(){$(".js-hotline-form-field-textarea").each((function(){$(this).focus()})),$(".js-hotline-form").on("submit",(function(){return $(this).find(":submit").attr("disabled",!0),$(this).find('input[name="token"]').val(""),!0}))})),$((function(){$(".js-lawonline-form").on("submit",(function(){return $(this).find(":submit").attr("disabled",!0),$(this).find('input[name="token"]').val(""),!0})),$(".js-lawonline-tabs-item").on("click",(function(){var t=$($(this).attr("href"));return t.length&&($(".lawonline-tabs-item-active").removeClass("lawonline-tabs-item-active"),$(this).addClass("lawonline-tabs-item-active"),$(".lawonline-content").hide(),t.show()),!1}))})),$(document).ready((function(){$(".js-reset-password-form").each((function(t){$(this).find("input:first").focus()}))})),$(document).ready((function(){$(".js-search-form-parameter-change").on("click",(function(t){if(t.preventDefault(),$(this).data("selected"))return!1;var e=new URLSearchParams(window.location.search);e.set($(this).data("parameter-name"),$(this).data("parameter-value")),e.set("offset",0),window.location=window.location.protocol+"//"+window.location.host+window.location.pathname+"?"+e.toString()})),$(".js-search-form-section-selector-select2").select2({placeholder:"Все разделы",language:{noResults:function(){return"Ничего не найдено"}}}),$(".js-search-form-field-query").each((function(t){var e=$(this).val();$(this).focus().val("").val(e)}))})),$((function(){$(".js-social-share-button-counter").on("share-counter-facebook",(function(t,e){$.ajax({type:"GET",url:"/social_network/facebook/share_count.json",data:{encodedURL:e},theCounter:$(this),success:function(t){t>0&&this.theCounter.html(String(t))}})})).on("share-counter-vkontakte",(function(t,e){$.getJSON(window.location.protocol+"//vkontakte.ru/share.php?act=count&index=1&url="+e+"&callback=?",(function(t){}))})).on("share-counter-twitter",(function(t,e){})).on("share-counter-googleplus",(function(t,e){var i=$(this);$.getJSON(window.location.protocol+"//share.yandex.ru/gpp.xml?url="+e+"&callback=?",(function(t){gpp_count=parseInt(t.replace(/\D/g,""),10),gpp_count>0&&i.html(String(gpp_count))}))})).on("share-counter-odnoklassniki",(function(t,e){})).on("share-counter-telegram",(function(t,e){})).each((function(t){var e=$(this).closest(".js-social-share-button").data("social-service");e&&$(this).trigger("share-counter-"+e,[$(this).closest(".js-social-share-button").data("encoded-url")])}))}));var VK={Share:{count:function(t,e){e>0&&$(".js-social-share-button-counter-vk").each((function(t,i){$(this).html(e)}))}}};$(document).ready((function(){$(".js-tag-description-expand").on("click",(function(t){var e=$($(this).data("target")),i=$(this).data("alt-text");$(this).data("alt-text",$(this).text()),$(this).text(i),e.toggleClass("collapsed"),$("html, body").animate({scrollTop:e.offset().top},400)})),$(".js-tag-map-region-selector").each((function(){$($(this).data("regions-map-container")).trigger("loadMap")}))})),$((function(){$(".js-tags-search-field").on("keyup",(function(t){$($(this).data("target")).trigger("filter",[$(this).val()])})),$(".js-tags-grid").on("filter",(function(t,e){""==e.trim()?($(this).find(".js-tags-grid-group-list-item").show(),$(this).find(".js-tags-grid-group").show()):e.trim().length>=2&&$(this).find(".tags-grid-group").trigger("filter-group",[e])})),$(".tags-grid-group").on("filter-group",(function(t,e){$(this).find('.js-tags-grid-group-list-item[data-tag-name*="'+e.trim().toLowerCase()+'"]').show(),$(this).find('.js-tags-grid-group-list-item:not([data-tag-name*="'+e.trim().toLowerCase()+'"])').hide(),$(this).find('.js-tags-grid-group-list-item[data-tag-name*="'+e.trim().toLowerCase()+'"]').length?$(this).show():$(this).hide()}))})),$(document).ready((function(){$(document).keypress((function(t){t.ctrlKey&&10===t.which&&(document.getSelection().isCollapsed||$(".js-typo-report-popup").trigger("show"))})),$(".js-typo-report-popup").on("show",(function(t){var e=$(this);if(t.preventDefault(),$(this).hasClass("active"))return!1;$(this).addClass("active");var i=document.getSelection(),o=i.getRangeAt(0).getBoundingClientRect(),s=50,n=$(".page").offset()||null;n&&null!=n.left&&(s+=n.left);e.css({position:"absolute",left:window.scrollX+s,top:window.scrollY+o.bottom+40});var a=i.toString(),r=i.getRangeAt(0),l=document.createRange(),c=document.createRange();l.setStartBefore(r.startContainer.ownerDocument.body),l.setEnd(r.startContainer,r.startOffset),c.setStart(r.endContainer,r.endOffset),c.setEndAfter(r.endContainer.ownerDocument.body);var d="..."+l.toString().substr(-50).replace(/^\S*\s/,"")+" ᐅ "+a+" ᐊ "+c.toString().substr(0,50).replace(/\s\S*$/,"")+"...";$(this).find("textarea#text-with-typo").val(d);$(this).find("textarea#optional-comment").val("Найдена ошибка/опечатка в следующем месте:"),$(this).find(".typo-report-popup-form-submit-button").show(),$(this).find(".typo-report-popup-form-thank-you").hide(),$(this).fadeIn(300);e=$(this);$("body").on("click.typoReportPopupHide",(function(t){(0==$(t.target).closest(e).length||$(t.target).hasClass("js-typo-report-popup-header-close"))&&e.trigger("hide")}))})).on("hide",(function(t){$(this).removeClass("active"),$(this).fadeOut(300),$("body").off("click.typoReportPopupHide")})),$(".js-typo-report-popup-form").on("submit",(function(t){t.preventDefault(),$(this).find('input[name="token"]').val(""),$.ajax({type:$(this).attr("method"),url:$(this).attr("action")+".json",data:$(this).serialize(),context:this,dataType:"json",success:function(t){$(this).find(".typo-report-popup-form-submit-button").hide(),$(this).find(".typo-report-popup-form-thank-you").show()},error:function(t){alert("Возникла ошибка при отправке сообщения"),console.log(t.responseJSON.error)}})}))}));